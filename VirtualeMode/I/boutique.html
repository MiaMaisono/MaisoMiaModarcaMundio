<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Ï»iapolVo â€” Free Boutique (144)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#000; --fg:#7F7F7F; --white:#FFF;
      --gap:12px; --phiInv:0.618033988749;  /* ç”»åƒã¯ã‚¿ã‚¤ãƒ«ã® 1/Ï† */
      --pad:72px;                           /* å››éš… UI ã®ä½œæ¥­ä½™ç™½ */
      --speed:.18s;
    }
    html,body{margin:0;height:100%;background:var(--bg);color:var(--fg);font-family:Georgia,serif;}
    a{color:inherit;text-decoration:none}

    /* ç”»é¢å…¨ä½“ */
    .stage{min-height:100vh;display:flex;flex-direction:column}

    /* ã‚°ãƒªãƒƒãƒ‰ï¼ˆä¸‹ã‹ã‚‰ä¸Šã«åŸ‹ã¾ã‚‹ï¼‰ */
    .wrap{flex:1;display:flex;align-items:flex-end;justify-content:center;padding:var(--pad) 12px}
    .grid{
      width:100%;max-width:1400px;
      display:grid;gap:var(--gap);
      grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
      align-content:end;
    }
    .card{background:var(--fg);aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .card img{max-width:calc(100%*var(--phiInv));max-height:calc(100%*var(--phiInv));display:block;object-fit:contain}

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ å››éš… UIï¼ˆã‚¢ã‚¤ã‚³ãƒ³â†’å±•é–‹ï¼‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .ctrl{position:fixed;z-index:10;display:flex;gap:8px;align-items:center}
    .TL{top:8px;left:8px}
    .TR{top:8px;right:8px}
    .BL{bottom:8px;left:8px}
    .BR{bottom:8px;right:8px}

    /* ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆæ ãªã—ãƒ»ç™½ï¼‰ */
    .icon-btn{
      appearance:none;border:none;background:transparent;color:var(--white);
      font:inherit;font-size:20px;line-height:1;cursor:pointer;padding:6px;
    }

    /* å±•é–‹ãƒ‘ãƒãƒ«ï¼ˆæ ãªã—ãƒ»é€éã€è¡¨ç¤º/éè¡¨ç¤ºã«ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ï¼‰ */
    .panel{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .panel.hidden{opacity:0;pointer-events:none;transform:translateY(-6px);transition:opacity var(--speed), transform var(--speed)}
    .panel.show  {opacity:1;transform:translateY(0);transition:opacity var(--speed), transform var(--speed)}

    /* ãƒœã‚¿ãƒ³ç¾¤ï¼ˆæ ãªã—ãƒ»ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ï¼‰ */
    .btn, .chip, .size-btn{
      appearance:none;border:none;background:transparent;color:var(--fg);
      cursor:pointer;font:inherit;padding:2px 4px;
    }
    .btn[data-active="true"], .chip[data-active="true"], .size-btn[data-active="true"]{color:var(--white)}

    /* ã‚µã‚¤ã‚ºå›³å½¢ï¼ˆâ– â–®â–¯ï¼‰ */
    .size-btn{font-size:18px;line-height:1}

    /* ã‚«ãƒ©ãƒ¼ï¼ˆèŠ±ã‚¢ã‚¤ã‚³ãƒ³ã§å±•é–‹ï¼‰ */
    .emoji{font-size:18px;line-height:1;padding:2px 3px}
    .emoji[data-active="true"]{color:var(--white)}

    /* å³ä¸‹ãƒ©ãƒ³ãƒ€ãƒ ï¼ˆâŸ²âŸ³ ãƒˆã‚°ãƒ«ï¼‰ */
    .rand[data-active="true"]{color:var(--white)}

    /* ãƒ•ãƒƒã‚¿ãƒ¼ï¼šä¸­å¤®ä¸‹ã®ãƒ–ãƒ©ãƒ³ãƒ‰ï¼ˆ48pxï¼‰ */
    .brand-wrap{position:fixed;left:0;right:0;bottom:20px;display:flex;justify-content:center;pointer-events:none}
    .brand{
      pointer-events:auto;color:var(--fg);font-size:48px;line-height:1;text-decoration:none;
    }
    .brand:hover{color:var(--white)}
  </style>
</head>
<body>
  <div class="stage">

    <!-- å·¦ä¸Šï¼šã‚«ãƒ†ã‚´ãƒªï¼ˆâ˜° â†’ All/ã‚¸ãƒ¥ã‚¨ãƒªãƒ¼/ãƒãƒƒã‚°/ã‚¦ã‚§ã‚¢/ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ -->
    <div class="ctrl TL">
      <button class="icon-btn" id="catToggle" aria-label="ã‚«ãƒ†ã‚´ãƒª">äº–</button>
      <div class="panel hidden" id="stylePanel" aria-label="ã‚¹ã‚¿ã‚¤ãƒ«">
        <button class="btn" data-style="all" data-active="true">All</button>
        <button class="btn" data-style="jewelry">ã‚¸ãƒ¥ã‚¨ãƒªãƒ¼</button>
        <button class="btn" data-style="bag">ãƒãƒƒã‚°</button>
        <button class="btn" data-style="wear">ã‚¦ã‚§ã‚¢</button>
        <button class="btn" data-style="pattern">ãƒ‘ã‚¿ãƒ¼ãƒ³</button>
      </div>
    </div>

    <!-- å³ä¸Šï¼šã‚µã‚¤ã‚ºï¼ˆâ—‡ â†’ â–  â–® â–¯ï¼‰â€»â—‡ã¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼å‘¼ã³å‡ºã—ç”¨ã‚¢ã‚¤ã‚³ãƒ³ -->
    <div class="ctrl TR">
      <button class="icon-btn" id="sizeToggle" aria-label="ã‚µã‚¤ã‚º">â—‡</button>
      <div class="panel hidden" id="sizePanel" aria-label="ã‚µã‚¤ã‚º">
        <button class="size-btn" data-size="square" title="æ­£æ–¹">â– </button>
        <button class="size-btn" data-size="tall"   title="ç¸¦é•·">â–®</button>
        <button class="size-btn" data-size="wide"   title="æ¨ªé•·">â–¯</button>
      </div>
    </div>

    <!-- å·¦ä¸‹ï¼šã‚«ãƒ©ãƒ¼ï¼ˆğŸ’ â†’ ğŸŒ·ğŸŒ¹ğŸ¥€ğŸª»ğŸª·ğŸŒºğŸŒ¸ğŸŒ¼ğŸŒ»ğŸµï¸ğŸ¥¦ï¼‰ -->
    <div class="ctrl BL">
      <button class="icon-btn" id="colorToggle" aria-label="ã‚«ãƒ©ãƒ¼">ğŸ’</button>
      <div class="panel hidden" id="colorPanel" aria-label="ã‚«ãƒ©ãƒ¼">
        <button class="emoji" data-color="pink">ğŸŒ·</button>
        <button class="emoji" data-color="red">ğŸŒ¹</button>
        <button class="emoji" data-color="black">ğŸ¥€</button>
        <button class="emoji" data-color="purple">ğŸª»</button>
        <button class="emoji" data-color="pink">ğŸª·</button>
        <button class="emoji" data-color="red">ğŸŒº</button>
        <button class="emoji" data-color="pink">ğŸŒ¸</button>
        <button class="emoji" data-color="yellow">ğŸŒ¼</button>
        <button class="emoji" data-color="yellow">ğŸŒ»</button>
        <button class="emoji" data-color="yellow">ğŸµï¸</button>
        <button class="emoji" data-color="green">ğŸ¥¦</button>
      </div>
    </div>

    <!-- å³ä¸‹ï¼šãƒ©ãƒ³ãƒ€ãƒ ï¼ˆâŸ²âŸ³ï¼‰ -->
    <div class="ctrl BR">
      <button class="icon-btn rand" id="randToggle" aria-label="ãƒ©ãƒ³ãƒ€ãƒ ">âŸ³</button>
    </div>

    <!-- ä¸€è¦§ï¼ˆä¸‹ã‹ã‚‰ä¸Šã¸åŸ‹ã¾ã‚‹ï¼‰ -->
    <main class="wrap">
      <section id="grid" class="grid" aria-live="polite"></section>
    </main>

    <!-- ä¸­å¤®ä¸‹ï¼šãƒ–ãƒ©ãƒ³ãƒ‰ 48px -->
    <div class="brand-wrap">
      <a class="brand" href="https://abcdefghijklnopqrstuw.xyz">VÏ»</a>
    </div>
  </div>

  <script>
    /* ===== ãƒ‡ãƒ¼ã‚¿ ===== */
    const DATA_URL = 'products.json';   // 144ç‚¹ã®ãƒ‡ãƒ¼ã‚¿
    const GRID = document.getElementById('grid');

    /* ===== UI é–‹é–‰ ===== */
    const toggles = [
      ['catToggle','stylePanel'],
      ['sizeToggle','sizePanel'],
      ['colorToggle','colorPanel']
    ];
    toggles.forEach(([btnId,panelId])=>{
      const b = document.getElementById(btnId);
      const p = document.getElementById(panelId);
      b.addEventListener('click', ()=>{
        const show = p.classList.contains('hidden');
        document.querySelectorAll('.panel').forEach(x=>x.classList.add('hidden'));
        if(show){ p.classList.remove('hidden'); p.classList.add('show'); }
        else    { p.classList.add('hidden'); p.classList.remove('show'); }
      });
    });
    // ã©ã“ã‹åˆ¥ã‚’ã‚¯ãƒªãƒƒã‚¯ã§å…¨éƒ¨é–‰ã˜ã‚‹
    document.addEventListener('click',(e)=>{
      if(e.target.closest('.ctrl')) return;
      document.querySelectorAll('.panel').forEach(x=>{x.classList.add('hidden');x.classList.remove('show');});
    });

    /* ===== çŠ¶æ…‹ ===== */
    let items = [];             // å…¨144
    let styleSel = 'all';       // jewelry/bag/wear/pattern/all
    let sizeSel  = null;        // tall/square/wide/null
    let colorsSel = new Set();  // è¤‡æ•°å¯
    let randSeed = 0;           // ç–‘ä¼¼ãƒ©ãƒ³ãƒ€ãƒ ã®ç¨®

    /* ===== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ===== */
    function shuffle(a, seed=0){
      const r = a.slice();
      let s = seed || Date.now();
      for(let i=r.length-1;i>0;i--){
        s ^= s << 13; s ^= s >> 17; s ^= s << 5; s >>>= 0;
        const j = Math.abs(s) % (i+1);
        [r[i], r[j]] = [r[j], r[i]];
      }
      return r;
    }
    function passStyle(it){ return (styleSel==='all') || (it.style===styleSel); }
    function passSize(it){ return !sizeSel || (it.size===sizeSel); }
    function passColor(it){
      if(colorsSel.size===0) return true;
      if(!Array.isArray(it.colors)) return false;
      for(const c of it.colors){ if(colorsSel.has(c)) return true; }
      return false;
    }
    function card(it){
      const el = document.createElement('article');
      el.className = 'card';
      const img = document.createElement('img');
      img.src = it.thumb; img.alt = it.title || 'Artwork';
      img.loading='lazy'; img.decoding='async';
      el.appendChild(img);
      return el;
    }
    function render(){
      const filtered = items.filter(it => passStyle(it)&&passSize(it)&&passColor(it));
      const listed = randSeed ? shuffle(filtered, randSeed) : filtered;
      GRID.innerHTML = '';
      for(const it of listed){ GRID.appendChild(card(it)); }
    }

    /* ===== ã‚¯ãƒªãƒƒã‚¯å‹•ä½œ ===== */
    // ã‚¹ã‚¿ã‚¤ãƒ«
    document.getElementById('stylePanel').addEventListener('click', e=>{
      const b = e.target.closest('.btn'); if(!b) return;
      styleSel = b.dataset.style;
      for(const el of e.currentTarget.querySelectorAll('.btn')) el.dataset.active = (el===b) ? "true" : "false";
      render();
    });
    // ã‚µã‚¤ã‚º
    document.getElementById('sizePanel').addEventListener('click', e=>{
      const b = e.target.closest('.size-btn'); if(!b) return;
      const prev = e.currentTarget.querySelector('[data-active="true"]');
      if(prev===b){ b.removeAttribute('data-active'); sizeSel=null; }
      else{
        if(prev) prev.removeAttribute('data-active');
        b.dataset.active = "true"; sizeSel = b.dataset.size;
      }
      render();
    });
    // ã‚«ãƒ©ãƒ¼ï¼ˆèŠ±ã‚¢ã‚¤ã‚³ãƒ³ï¼‰
    document.getElementById('colorPanel').addEventListener('click', e=>{
      const c = e.target.closest('.emoji'); if(!c) return;
      const name = c.dataset.color;
      if(c.dataset.active==="true"){ c.dataset.active="false"; colorsSel.delete(name); }
      else{ c.dataset.active="true"; colorsSel.add(name); }
      render();
    });
    // ãƒ©ãƒ³ãƒ€ãƒ ï¼ˆâŸ²âŸ³ï¼‰
    document.getElementById('randToggle').addEventListener('click', e=>{
      const b = e.currentTarget;
      randSeed = (randSeed?0:Date.now());
      b.dataset.active = randSeed ? "true":"false";
      render();
    });

    /* ===== ãƒ‡ãƒ¼ã‚¿èª­è¾¼ ===== */
    (async () => {
      const res = await fetch('products.json');
      const data = await res.json();
      items = data.sort((a,b)=>(a.order||0)-(b.order||0));  // å®‰å®šé †
      render();
    })();
  </script>
</body>
</html>
