<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>#i</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <style>
    :root{
      --bg:#000;
      --fg:#7F7F7F;
      --white:#FFF;
      --radius:26.5px;
    }

    /* ϻiapolVo 共通の黒 + Græy 外周 + 角丸 */
    html,body{
      margin:0;
      height:100%;
      background:var(--bg);
      color:var(--fg);
      font-family:Georgia,serif;
    }
    body{
      border-radius:var(--radius);
      outline:12px solid #7f7f7f;   /* Græy 外周 */
      box-shadow:0 0 0 0px #fff inset;
      overflow:hidden;
    }

    /* 中央縦長カラム */
    .wrap{
      min-height:100dvh;
      display:flex;
      align-items:center;
      justify-content:center;
      box-sizing:border-box;
      padding:24px;
    }
    .column{
      width:min(90vw,340px);
      display:flex;
      flex-direction:column;
      gap:16px;
      align-items:center;
    }

    /* 額（共通） */
    .frame{
      position:relative;
      width:100%;
      aspect-ratio:1/1;
      background:var(--fg);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .frame img{
      display:block;
      object-fit:contain;
      max-width:100%;
      max-height:100%;
      transition:transform .18s ease, max-width .18s ease, max-height .18s ease;
    }

    /* 大枠：縦長 1 : 1.618 */
    .hero{
      width:100%;
      aspect-ratio:1/1.618;
    }

    /* サムネイル 3列グリッド（合計 144） */
    .thumbs{
      width:100%;
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:8px;
    }
    .thumb{
      cursor:pointer;
      border:none;
      padding:0;
      background:transparent;
    }

    /* ───────── Femme / Homme モード ───────── */

    /* Femme: 額を45°回転したダイヤ、画像を -45° で戻す。
       角にぴったり来るよう 140% まで拡大。 */
    body.femme .frame{
      transform:rotate(45deg);
    }
    body.femme .frame img{
      transform:rotate(-45deg);
      max-width:140%;
      max-height:140%;
    }

    /* Homme: 正方形の中に長辺を 1/√2 に縮小して配置 */
    body.homme .frame{
      transform:none;
    }
    body.homme .frame img{
      transform:none;
      max-width:calc(100% / 1.41421356237);
      max-height:calc(100% / 1.41421356237);
    }

    /* キャプション */
    .label{
      margin-top:8px;
      font-size:12px;
      opacity:.85;
    }

    /* 右上モード切替 UI（Femme / Homme） */
    .mode-toggle{
      position:fixed;
      top:10px;
      right:16px;
      display:flex;
      gap:6px;
      font-size:12px;
      z-index:20;
    }
    .mode-btn{
      border:none;
      padding:2px 4px;
      background:transparent;
      color:var(--fg);
      cursor:pointer;
      font:inherit;
      -webkit-tap-highlight-color:transparent;
    }
    .mode-btn[data-active="true"]{
      color:var(--white);
    }
  </style>
</head>

<body class="femme"> <!-- 初期状態は Femme にしています -->
  <!-- Femme / Homme トグル -->
  <div class="mode-toggle" aria-label="display mode">
    <button id="btnFemme" class="mode-btn" data-active="true">Femme</button>
    /
    <button id="btnHomme" class="mode-btn">Homme</button>
  </div>

  <main class="wrap">
    <section class="column" aria-label="#i gallery">
      <!-- 大枠：original を表示。クリックで原寸を新タブ -->
      <a class="frame hero" id="heroLink" href="#" target="_blank" rel="noopener">
        <img id="heroImg" src="" alt="#i drawing" loading="eager" decoding="async">
      </a>

      <!-- 144枚のサムネイル -->
      <div class="thumbs" id="thumbs" aria-label="thumbnails"></div>

      <div class="label">ineffabilis / ineffable / ineffabile / inefavlo</div>
    </section>
  </main>

  <script>
    /* ==== 画像データ：同じリポジトリ内の JSON から読み込む ==== */
    // 例：./i-images.json
    const DATA_URL = 'i-images.json';

    const heroImg  = document.getElementById('heroImg');
    const heroLink = document.getElementById('heroLink');
    const thumbsEl = document.getElementById('thumbs');

    const btnFemme = document.getElementById('btnFemme');
    const btnHomme = document.getElementById('btnHomme');

    /* ---- Femme / Homme の UI 切替 ---- */
    function setMode(mode){
      const isFemme = mode === 'femme';
      document.body.classList.toggle('femme', isFemme);
      document.body.classList.toggle('homme', !isFemme);
      btnFemme.dataset.active = isFemme ? 'true' : 'false';
      btnHomme.dataset.active = !isFemme ? 'true' : 'false';
    }

    btnFemme.addEventListener('click', ()=> setMode('femme'));
    btnHomme.addEventListener('click', ()=> setMode('homme'));

    /* ---- ギャラリー部分 ---- */

    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }

    function setHero(item){
      heroImg.src = item.original;
      heroImg.alt = item.title || '#i drawing';
      heroLink.href = item.original;
    }

    function render(list){
      const shuffled = shuffle(list);
      const [first, ...rest] = shuffled;

      setHero(first);

      thumbsEl.innerHTML = '';
      rest.forEach(item=>{
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'frame thumb';

        const img = document.createElement('img');
        img.src = item.thumb || item.original;
        img.alt = item.title || '';
        img.loading  = 'lazy';
        img.decoding = 'async';

        btn.appendChild(img);
        btn.addEventListener('click', ()=> setHero(item));
        thumbsEl.appendChild(btn);
      });
    }

    (async ()=>{
      try{
        const res  = await fetch(DATA_URL);
        const data = await res.json();  // 145件（original, thumb）だけ
        render(data);
      }catch(e){
        console.error(e);
      }
      // 初期モード（Femme）
      setMode('femme');
    })();
  </script>
</body>
</html>
