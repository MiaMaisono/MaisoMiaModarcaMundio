<!doctype html>
<html lang=en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title> Ù…Ø­ÙØ¸Ø© / â„³ğ’¶ğ’½ğ’»ğ’¶ğ“ğ’¶ğ“‰ </title>
  <meta name="color-scheme" content="dark">

  <!-- === ç¬¬ä¸€æ®µéš CSSï¼ˆã‚ãªãŸã®å…ƒã‚³ãƒ¼ãƒ‰ã‚’ä¿æŒï¼‰ === -->
  <style>
    :root { --bg:#000; --fg:#e5e5e5; --muted:#7f7f7f; }
    html, body { margin:0; background:var(--bg); color:var(--fg); font-family: system-ui, -apple-system, Helvetica, Arial, "Noto Sans JP", sans-serif; }
    .wrap { max-width: 1080px; margin: 0 auto; padding: 32px 20px 80px; }
    header { display:flex; align-items:baseline; gap:16px; margin-bottom: 24px; }
    header a { color: var(--muted); text-decoration: none; }
    header a:hover { text-decoration: underline; }
    h1 { font-size: 24px; margin: 0; }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
    .card { background:#0b0b0b; border:1px solid #1a1a1a; border-radius:12px; padding:12px; }
    .thumb { aspect-ratio:1/1; width:100%; background:#111; border-radius:10px; object-fit:cover; }
    .meta { margin-top:8px; font-size:13px; color:var(--muted); line-height:1.5; }
    .title { font-size:14px; margin-top:8px; }

    body{
      border-radius:26.5px;
      outline:12px solid #7f7f7f;       /* GrÃ¦y */
      box-shadow:0 0 0 0px #fff inset;  /* å†…å´ç™½æ */
      overflow:hidden;
    }
  </style>

  <!-- === ç¬¬äºŒæ®µéš CSSï¼ˆã“ã‚Œã‚‚å…¨ã¦å…ƒã‚³ãƒ¼ãƒ‰ã®ã¾ã¾ã€æ­£ã—ã„ä½ç½®ã¸ç§»å‹•ï¼‰ === -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#000; --fg:#7F7F7F; --white:#FFF;
      --gap:12px; --phiInv:0.618033988749;
      --pad:72px;
      --speed:.18s;
    }
    html,body{margin:0;height:100%;background:var(--bg);color:var(--fg);font-family:Georgia,serif;}
    a{color:inherit;text-decoration:none}

    /* å…¨ä½“ */
    .stage{min-height:100vh;display:flex;flex-direction:column}

    /* å•†å“ã‚°ãƒªãƒƒãƒ‰ */
    .wrap{flex:1;display:flex;align-items:flex-end;justify-content:center;padding:var(--pad) 12px}
    .grid{
      width:100%;max-width:1400px;
      display:grid;gap:var(--gap);
      grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
      align-content:end;
    }
    .card{background:var(--fg);aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .card img{max-width:calc(100%*var(--phiInv));max-height:calc(100%*var(--phiInv));display:block;object-fit:contain}

    /* å››éš…UI */
    .ctrl{position:fixed;z-index:10;display:flex;gap:8px;align-items:center}
    .TL{top:8px;left:8px}
    .BL{bottom:8px;left:8px}
    .BR{bottom:8px;right:8px}
    .TR{
      top:8px; right:8px;
      position:fixed;
      display:flex; flex-direction:row-reverse; gap:8px; align-items:center;
    }
    #sizePanel{display:flex;flex-direction:row-reverse;justify-content:flex-end}

    /* å±•é–‹ã‚¢ãƒ‹ãƒ¡ */
    .panel{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .panel.hidden{opacity:0;pointer-events:none;transform:translateY(-6px);transition:opacity var(--speed),transform var(--speed)}
    .panel.show  {opacity:1;transform:translateY(0);transition:opacity var(--speed),transform var(--speed)}
    .TR .panel.hidden{transform:translateX(8px)}
    .TR .panel.show  {transform:translateX(0)}
    .TR .icon-btn{padding-right:2px}

    /* ãƒœã‚¿ãƒ³ */
    .icon-btn{
      appearance:none;border:none;background:transparent;color:var(--white);
      font:inherit;font-size:20px;line-height:1;cursor:pointer;padding:6px;
    }
    .btn, .chip, .size-btn{
      appearance:none;border:none;background:transparent;color:var(--fg);
      cursor:pointer;font:inherit;padding:2px 4px;
    }
    .btn[data-active="true"], .chip[data-active="true"], .size-btn[data-active="true"]{color:var(--white)}

    .size-btn{font-size:18px;line-height:1}

    .emoji{font-size:18px;line-height:1;padding:2px 3px}
    .emoji[data-active="true"]{color:var(--white)}
    .rand[data-active="true"]{color:var(--white)}

    /* ãƒ–ãƒ©ãƒ³ãƒ‰ */
    .brand-wrap{position:fixed;left:0;right:0;bottom:19px;display:flex;justify-content:center;pointer-events:none}
    .brand{pointer-events:auto;color:var(--fg);font-size:19px;line-height:1;text-decoration:none}
    .brand:hover{color:var(--white)}

    /* å†å®šç¾© bodyï¼ˆå…ƒã‚³ãƒ¼ãƒ‰ã®ã¾ã¾ä¿æŒï¼‰ */
    body {
      margin: 0; height: 100vh;background: #000;
      border-radius: 26.5px;
      outline: 12px solid #7f7f7f;
      box-shadow: 0 0 0 0px #fff inset;
      overflow: hidden;
    }
  </style>
</head>

<body>

  <div class="stage">

    <!-- å·¦ä¸Šã‚«ãƒ†ã‚´ãƒª -->
    <div class="ctrl TL">
      <button class="icon-btn" id="catToggle" aria-label="ã‚«ãƒ†ã‚´ãƒª">äº–</button>
      <div class="panel hidden" id="stylePanel" aria-label="ã‚¹ã‚¿ã‚¤ãƒ«">
        <button class="btn" data-style="all" data-active="true">All</button>
        <button class="btn" data-style="jewelry">ã‚¸ãƒ¥ã‚¨ãƒªãƒ¼</button>
        <button class="btn" data-style="bag">ãƒãƒƒã‚°</button>
        <button class="btn" data-style="wear">ã‚¦ã‚§ã‚¢</button>
        <button class="btn" data-style="pattern">ãƒ‘ã‚¿ãƒ¼ãƒ³</button>
      </div>
    </div>

    <!-- å³ä¸Šã‚µã‚¤ã‚º -->
    <div class="ctrl TR">
      <button class="icon-btn" id="sizeToggle" aria-label="ã‚µã‚¤ã‚º">â—‡</button>
      <div class="panel hidden" id="sizePanel" aria-label="ã‚µã‚¤ã‚º">
        <button class="size-btn" data-size="square" title="æ­£æ–¹å½¢">â–¡</button>
        <button class="size-btn" data-size="tall"   title="ç¸¦é•·">â–¯</button>
        <button class="size-btn" data-size="wide"   title="æ¨ªé•·">â–­</button>
      </div>
    </div>

    <!-- å·¦ä¸‹ã‚«ãƒ©ãƒ¼ -->
    <div class="ctrl BL">
      <button class="icon-btn" id="colorToggle" aria-label="ã‚«ãƒ©ãƒ¼">ğŸ’</button>
      <div class="panel hidden" id="colorPanel" aria-label="ã‚«ãƒ©ãƒ¼">
        <button class="emoji" data-color="pink">ğŸŒ·</button>
        <button class="emoji" data-color="red">ğŸŒ¹</button>
        <button class="emoji" data-color="black">ğŸ¥€</button>
        <button class="emoji" data-color="purple">ğŸª»</button>
        <button class="emoji" data-color="pink">ğŸª·</button>
        <button class="emoji" data-color="red">ğŸŒº</button>
        <button class="emoji" data-color="pink">ğŸŒ¸</button>
        <button class="emoji" data-color="yellow">ğŸŒ¼</button>
        <button class="emoji" data-color="yellow">ğŸŒ»</button>
        <button class="emoji" data-color="yellow">ğŸµï¸</button>
        <button class="emoji" data-color="green">ğŸ¥¦</button>
      </div>
    </div>

    <!-- å³ä¸‹ãƒ©ãƒ³ãƒ€ãƒ  -->
    <div class="ctrl BR">
      <button class="icon-btn rand" id="randToggle" aria-label="ãƒ©ãƒ³ãƒ€ãƒ ">âŸ³</button>
    </div>

    <!-- ã‚°ãƒªãƒƒãƒ‰ -->
    <main class="wrap">
      <section id="grid" class="grid" aria-live="polite"></section>
    </main>

    <!-- ãƒ–ãƒ©ãƒ³ãƒ‰ -->
    <div class="brand-wrap">
      <a class="brand" href="entrance.html">VÏ»</a>
    </div>

  </div>

  <!-- === JSï¼ˆã‚ãªãŸã®å…ƒã‚³ãƒ¼ãƒ‰ã‚’å®Œå…¨ä¿æŒï¼‰ === -->
  <script>
    const DATA_URL = 'products.json';
    const GRID = document.getElementById('grid');

    const TOGGLE_MAP = {
      catToggle:  'stylePanel',
      sizeToggle: 'sizePanel',
      colorToggle:'colorPanel'
    };
    for (const [btnId,panelId] of Object.entries(TOGGLE_MAP)) {
      const btn = document.getElementById(btnId);
      const panel = document.getElementById(panelId);
      btn.addEventListener('click', (e)=>{
        e.stopPropagation();
        const willOpen = panel.classList.contains('hidden');
        document.querySelectorAll('.panel').forEach(x=>{x.classList.add('hidden');x.classList.remove('show');});
        if (willOpen){ panel.classList.remove('hidden'); panel.classList.add('show'); }
      });
      panel.addEventListener('click', (e)=>e.stopPropagation());
    }
    document.addEventListener('click', ()=>{
      document.querySelectorAll('.panel').forEach(x=>{x.classList.add('hidden');x.classList.remove('show');});
    });

    let items = [];
    let styleSel = 'all';
    let sizeSel  = null;
    let colorsSel = new Set();
    let randSeed = 0;

    function shuffle(a, seed=0){
      const r = a.slice();
      let s = seed || Date.now();
      for(let i=r.length-1;i>0;i--){
        s ^= s << 13; s ^= s >> 17; s ^= s << 5; s >>>= 0;
        const j = Math.abs(s) % (i+1);
        [r[i], r[j]] = [r[j], r[i]];
      }
      return r;
    }
    function passStyle(it){ return (styleSel==='all') || (it.style===styleSel); }
    function passSize(it){ return !sizeSel || (it.size===sizeSel); }
    function passColor(it){
      if(colorsSel.size===0) return true;
      if(!Array.isArray(it.colors)) return false;
      for(const c of it.colors){ if(colorsSel.has(c)) return true; }
      return false;
    }
    function card(it){
      const el = document.createElement('article');
      el.className = 'card';
      const img = document.createElement('img');
      img.src = it.thumb; img.alt = it.title || 'Artwork';
      img.loading='lazy'; img.decoding='async';
      el.appendChild(img);
      return el;
    }
    function render(){
      const filtered = items.filter(it => passStyle(it)&&passSize(it)&&passColor(it));
      const listed = randSeed ? shuffle(filtered, randSeed) : filtered;
      GRID.innerHTML = '';
      for(const it of listed){ GRID.appendChild(card(it)); }
    }

    document.getElementById('stylePanel').addEventListener('click', e=>{
      const b = e.target.closest('.btn'); if(!b) return;
      styleSel = b.dataset.style;
      for(const el of e.currentTarget.querySelectorAll('.btn')) el.dataset.active = (el===b) ? "true" : "false";
      render();
    });

    document.getElementById('sizePanel').addEventListener('click', e=>{
      const b = e.target.closest('.size-btn'); if(!b) return;
      const prev = e.currentTarget.querySelector('[data-active="true"]');
      if(prev===b){ b.removeAttribute('data-active'); sizeSel=null; }
      else{
        if(prev) prev.removeAttribute('data-active');
        b.dataset.active = "true"; sizeSel = b.dataset.size;
      }
      render();
    });

    document.getElementById('colorPanel').addEventListener('click', e=>{
      const c = e.target.closest('.emoji'); if(!c) return;
      const name = c.dataset.color;
      if(c.dataset.active==="true"){ c.dataset.active="false"; colorsSel.delete(name); }
      else{ c.dataset.active="true"; colorsSel.add(name); }
      render();
    });

    document.getElementById('randToggle').addEventListener('click', e=>{
      const b = e.currentTarget;
      randSeed = (randSeed?0:Date.now());
      b.dataset.active = randSeed ? "true":"false";
      render();
    });

    (async () => {
      const res = await fetch(DATA_URL);
      const data = await res.json();
      items = data.sort((a,b)=>(a.order||0)-(b.order||0));
      render();
    })();
  </script>

</body>
</html>
